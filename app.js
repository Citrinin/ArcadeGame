!function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return c(a[t][1][e]||e)},i,i.exports,o,a,s,u)}return s[t].exports}for(var h="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("./person"),a=(i=o)&&i.__esModule?i:{default:i};var s=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,".dummy-enemy-img"));return t.width=100,t.height=126,t.position={x:Math.abs(t.width-t.game.width*Math.random()),y:t.game.height/2*Math.random()},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a.default),n}();n.default=s},{"./person":4}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=s(e("./hero")),o=s(e("./dummyEnemy")),a=s(e("../utils/firebase"));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=800,this.height=800,this.level=1,this.baseSpeed=0,this.canvas=document.querySelector("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.characters=new Array(2).fill(0).map(function(){return new o.default(e)}),this.hero=new i.default(this),this.gamePlays=!1,this.timerHandler=0,this.gameTimer=0,this.setUpGame()}return r(t,[{key:"setUpGame",value:function(){var t=this;this.timerHandler=setInterval(function(){t.context.clearRect(0,0,t.width,t.height),t.characters.forEach(function(e){return t.checkCharactersIntersection(t.hero,e)}),t.drawCharacter(t.hero),t.characters.forEach(function(e){return t.drawCharacter(e)})},30)}},{key:"drawCharacter",value:function(e){e.imageOrientation()?(this.context.save(),this.context.scale(-1,1),this.context.drawImage(e.getNextSprite(),-1*e.position.x,e.position.y,-1*e.width,e.height),this.context.restore()):this.context.drawImage(e.getNextSprite(),e.position.x,e.position.y,e.width,e.height)}},{key:"runGame",value:function(){this.gameTimer=(new Date).getTime(),this.gamePlays=!0,this.baseSpeed=5}},{key:"endGame",value:function(){clearInterval(this.timerHandler),this.gamePlays=!1,this.baseSpeed=0;var e=((new Date).getTime()-this.gameTimer)/1e3,t=prompt("Your score is "+e+" secongs.\n Enter your name","Ninja");t&&a.default.saveScore({name:t,score:e})}},{key:"checkCharactersIntersection",value:function(e,t){e.position.x+30<=t.position.x+t.width&&e.position.x+e.width>=t.position.x+30&&e.position.y+5<=t.position.y+t.height&&e.position.y+e.height>=t.position.y+5&&(e.die(),this.endGame())}}]),t}();n.default=u},{"../utils/firebase":8,"./dummyEnemy":1,"./hero":3}],3:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i,o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),a=e("./person"),s=(i=a)&&i.__esModule?i:{default:i};var u=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,".cat-img"));return t.setUpHero(),t.width=115,t.height=100,t.position={x:(t.game.width-t.width)/2,y:t.game.height-t.height},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,s.default),o(n,[{key:"setUpHero",value:function(){var t=this;document.addEventListener("keydown",function(e){e.keyCode<37||40<e.keyCode||(t.game.gamePlays||(t.game.runGame(),t.speed=t.game.baseSpeed*t.game.level),37===e.keyCode&&(t.directionAngle=Math.PI),38===e.keyCode&&(t.directionAngle=Math.PI/2*3),39===e.keyCode&&(t.directionAngle=0),40===e.keyCode&&(t.directionAngle=Math.PI/2))})}},{key:"die",value:function(){this.sprites=[].slice.call(document.querySelectorAll(".cat-dead-img"))}}]),n}();n.default=u},{"./person":4}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.game=e,this.directionAngle=2*Math.PI*Math.random(),this.position={x:0,y:0},this.sprites=[].slice.call(document.querySelectorAll(t)),this.speed=e.level*e.baseSpeed,this.currentImg=0}return r(n,[{key:"getNextSprite",value:function(){return this.step(),this.currentImg>=this.sprites.length&&(this.currentImg=0),this.sprites[this.currentImg++]}},{key:"step",value:function(){this.speed=this.game.baseSpeed*this.game.level,this.position.x+=Math.cos(this.directionAngle)*this.speed,this.position.x+this.width/2>this.game.width&&(this.position.x=-this.width/2),this.position.x+this.width/2<0&&(this.position.x=this.game.width-this.width/2),this.position.y+=Math.sin(this.directionAngle)*this.speed,this.position.y+this.height/2>this.game.height&&(this.position.y=-this.height/2),this.position.y+this.height/2<0&&(this.position.y=this.game.height-this.height/2)}},{key:"imageOrientation",value:function(){return this.directionAngle>=Math.PI/2&&this.directionAngle<=3*Math.PI/2}}]),n}();n.default=i},{}],5:[function(e,t,n){"use strict";var r=o(e("./utils/router")),i=o(e("./routes"));function o(e){return e&&e.__esModule?e:{default:e}}new r.default(i.default)},{"./routes":6,"./utils/router":9}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=a(e("./gameObjects/gameState")),o=a(e("./utils/detectMobile")),i=a(e("./utils/firebase"));function a(e){return e&&e.__esModule?e:{default:e}}var s=document.querySelector(".content");!function(){if((0,o.default)()){var e=document.createElement("div");e.classList.add("buttons");var t=document.createElement("button");t.innerHTML="<",t.classList.add("left");var n=document.createElement("button");n.innerHTML="^",n.classList.add("up");var r=document.createElement("button");r.innerHTML=">",r.classList.add("right");var i=document.createElement("button");i.innerHTML="v",i.classList.add("down"),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.addEventListener("click",function(e){if(e.target.matches(".right")){var t=new Event("keydown");return t.keyCode=39,void document.dispatchEvent(t)}if(e.target.matches(".left")){var n=new Event("keydown");return n.keyCode=37,void document.dispatchEvent(n)}if(e.target.matches(".up")){var r=new Event("keydown");return r.keyCode=38,void document.dispatchEvent(r)}if(e.target.matches(".down")){var i=new Event("keydown");return i.keyCode=40,void document.dispatchEvent(i)}}),document.body.appendChild(e)}}();var u=[{match:"",onEnter:function(){window.location.hash="game"}},{match:"about",onEnter:function(){c("about"),s.innerHTML='<h1 class="about"><span>Super game Cat vs Ninjas</span><h1>'}},{match:"game",onEnter:function(){c("game");var e=document.createElement("canvas");s.innerHTML="",s.appendChild(e),new r.default}},{match:"scores",onEnter:function(){c("scores"),i.default.getScores().then(function(e){s.innerHTML='<h1 class="about"><span>Scores</span></h1>';var n=document.createElement("ol");e.forEach(function(e){var t=document.createElement("li");t.innerHTML=e.name+" - "+e.score,n.appendChild(t)});var t=document.createElement("div");t.classList.add("w-100"),s.appendChild(t);var r=document.createElement("div");r.appendChild(n),s.appendChild(r)})}}];function c(e){document.querySelector(".active").className="",document.querySelector('[href="#'+e+'"]').parentElement.className="active"}n.default=u},{"./gameObjects/gameState":2,"./utils/detectMobile":7,"./utils/firebase":8}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var i="https://kate-arcade-game.firebaseio.com/.json",o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"getScores",value:function(){return fetch(i+"?print=pretty").then(function(e){return e.json()}).then(function(e){var t=[];for(var n in e)t.push(e[n]);return t.sort(function(e,t){return e.score>t.score?-1:e.score<t.score?1:0})})}},{key:"saveScore",value:function(e){fetch(i,{method:"POST",body:JSON.stringify(e)})}}]),e}();n.default=o},{}],9:[function(e,t,n){"use strict";function r(e){var t=this;this.routes=e||[],this.currentRoute,this.previousRoute,this.currentParams,this.previousParams,window.addEventListener("hashchange",function(){t.handler(window.location.hash)}),this.handler(window.location.hash)}Object.defineProperty(n,"__esModule",{value:!0}),(n.default=r).prototype={handler:function(e){this.previousRoute=this.currentRoute,this.previousParams=this.currentParams,this.currentRoute=this.findNewRoute(e),this.launchHandlers()},findNewRoute:function(e){e=e.slice(1);for(var t=0;t<this.routes.length;t++){var n=this.routes[t];if("string"==typeof n.match&&n.match===e)return this.currentParams="",n;if("function"==typeof n.match&&n.match(e))return this.currentParams="",n;if(n.match instanceof RegExp&&n.match.test(e))return this.currentParams=e.match(n.match)||[],this.currentParams.splice(0,1),n}},launchHandlers:function(){var e=this;Promise.resolve().then(function(){e.previousRoute&&e.previousRoute.onLeave&&e.previousRoute.onLeave(e.previousParams)}).then(function(){e.currentRoute&&e.currentRoute.onBeforeEnter&&e.currentRoute.onBeforeEnter(e.currentParams)}).then(function(){e.currentRoute&&e.currentRoute.onEnter&&e.currentRoute.onEnter(e.currentParams)})}}},{}]},{},[5]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZ2FtZU9iamVjdHMvZHVtbXlFbmVteS5qcyIsInNyYy9qcy9nYW1lT2JqZWN0cy9nYW1lU3RhdGUuanMiLCJzcmMvanMvZ2FtZU9iamVjdHMvaGVyby5qcyIsInNyYy9qcy9nYW1lT2JqZWN0cy9wZXJzb24uanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9yb3V0ZXMuanMiLCJzcmMvanMvdXRpbHMvZGV0ZWN0TW9iaWxlLmpzIiwic3JjL2pzL3V0aWxzL2ZpcmViYXNlLmpzIiwic3JjL2pzL3V0aWxzL3JvdXRlci5qcyJdLCJuYW1lcyI6WyJyIiwiZSIsIm4iLCJ0IiwibyIsImkiLCJmIiwiYyIsInJlcXVpcmUiLCJ1IiwiYSIsIkVycm9yIiwiY29kZSIsInAiLCJleHBvcnRzIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJtb2R1bGUiLCJfcGVyc29uIiwiRHVtbXlFbmVteSIsImdhbWVTdGF0ZSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfdGhpcyIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiX19wcm90b19fIiwiT2JqZWN0IiwiZ2V0UHJvdG90eXBlT2YiLCJ3aWR0aCIsImhlaWdodCIsInBvc2l0aW9uIiwieCIsIk1hdGgiLCJhYnMiLCJnYW1lIiwicmFuZG9tIiwieSIsIl9wZXJzb24yIiwiZGVmYXVsdCIsIkdhbWVTdGF0ZSIsImxldmVsIiwiYmFzZVNwZWVkIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGV4dCIsImdldENvbnRleHQiLCJjaGFyYWN0ZXJzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiX2R1bW15RW5lbXkyIiwiaGVybyIsIl9oZXJvMiIsImdhbWVQbGF5cyIsInRpbWVySGFuZGxlciIsImdhbWVUaW1lciIsInNldFVwR2FtZSIsIl90aGlzMiIsInNldEludGVydmFsIiwiY2xlYXJSZWN0IiwiZm9yRWFjaCIsImNoYXJhY3RlciIsImNoZWNrQ2hhcmFjdGVyc0ludGVyc2VjdGlvbiIsImRyYXdDaGFyYWN0ZXIiLCJpbWFnZU9yaWVudGF0aW9uIiwic2F2ZSIsInNjYWxlIiwiZHJhd0ltYWdlIiwiZ2V0TmV4dFNwcml0ZSIsInJlc3RvcmUiLCJEYXRlIiwiZ2V0VGltZSIsImNsZWFySW50ZXJ2YWwiLCJzY29yZSIsIm5hbWUiLCJwcm9tcHQiLCJfZmlyZWJhc2UyIiwic2F2ZVNjb3JlIiwiZW5lbXkiLCJkaWUiLCJlbmRHYW1lIiwiSGVybyIsInNldFVwSGVybyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleUNvZGUiLCJydW5HYW1lIiwic3BlZWQiLCJkaXJlY3Rpb25BbmdsZSIsIlBJIiwic3ByaXRlcyIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsIlBlcnNvbiIsInNlbGVjdG9yIiwiY3VycmVudEltZyIsInN0ZXAiLCJjb3MiLCJzaW4iLCJfcm91dGVyMiIsIl9yb3V0ZXMyIiwiY29udGVudCIsIl9kZXRlY3RNb2JpbGUyIiwiZGl2Rm9yQnV0dG9ucyIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJidXR0b25MZWZ0IiwiaW5uZXJIVE1MIiwiYnV0dG9uVXAiLCJidXR0b25SaWdodCIsImJ1dHRvbkRvd24iLCJhcHBlbmRDaGlsZCIsInRhcmdldCIsIm1hdGNoZXMiLCJFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJfZSIsIl9lMiIsIl9lMyIsImJvZHkiLCJhZGRCdXR0b25zRm9yTW9iaWxlIiwicm91dGVzIiwibWF0Y2giLCJvbkVudGVyIiwid2luZG93IiwibG9jYXRpb24iLCJoYXNoIiwiY2hhbmdlQWN0aXZlUGFnZSIsIl9nYW1lU3RhdGUyIiwiZ2V0U2NvcmVzIiwidGhlbiIsInJlc3VsdCIsIm9sIiwiaXRlbSIsImxpIiwiZGl2Rm9yRGl2aXNpb24iLCJkaXYiLCJuZXdQYWdlIiwiY2xhc3NOYW1lIiwicGFyZW50RWxlbWVudCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInVybCIsIkZpcmVTdG9yZSIsImZldGNoIiwicmVzcG9uc2UiLCJqc29uIiwiYXJyYXlSZXN1bHQiLCJrZXkiLCJwdXNoIiwic29ydCIsIml0ZW0xIiwiaXRlbTIiLCJpbmZvVG9TYXZlIiwibWV0aG9kIiwiSlNPTiIsInN0cmluZ2lmeSIsIlJvdXRlciIsInJvdXRlUGFyYW1zIiwiY3VycmVudFJvdXRlIiwicHJldmlvdXNSb3V0ZSIsImN1cnJlbnRQYXJhbXMiLCJwcmV2aW91c1BhcmFtcyIsImhhbmRsZXIiLCJwcm90b3R5cGUiLCJmaW5kTmV3Um91dGUiLCJsYXVuY2hIYW5kbGVycyIsImVsZW1lbnQiLCJSZWdFeHAiLCJ0ZXN0Iiwic3BsaWNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvbkxlYXZlIiwib25CZWZvcmVFbnRlciJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsRUFBQUMsRUFBQUMsR0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUFBLElBQUFKLEVBQUFHLEdBQUEsQ0FBQSxJQUFBSixFQUFBSSxHQUFBLENBQUEsSUFBQUUsRUFBQSxtQkFBQUMsU0FBQUEsUUFBQSxJQUFBRixHQUFBQyxFQUFBLE9BQUFBLEVBQUFGLEdBQUEsR0FBQSxHQUFBSSxFQUFBLE9BQUFBLEVBQUFKLEdBQUEsR0FBQSxJQUFBSyxFQUFBLElBQUFDLE1BQUEsdUJBQUFOLEVBQUEsS0FBQSxNQUFBSyxFQUFBRSxLQUFBLG1CQUFBRixFQUFBLElBQUFHLEVBQUFYLEVBQUFHLEdBQUEsQ0FBQVMsUUFBQSxJQUFBYixFQUFBSSxHQUFBLEdBQUFVLEtBQUFGLEVBQUFDLFFBQUEsU0FBQWQsR0FBQSxPQUFBSSxFQUFBSCxFQUFBSSxHQUFBLEdBQUFMLElBQUFBLElBQUFhLEVBQUFBLEVBQUFDLFFBQUFkLEVBQUFDLEVBQUFDLEVBQUFDLEdBQUEsT0FBQUQsRUFBQUcsR0FBQVMsUUFBQSxJQUFBLElBQUFMLEVBQUEsbUJBQUFELFNBQUFBLFFBQUFILEVBQUEsRUFBQUEsRUFBQUYsRUFBQWEsT0FBQVgs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QUFRMUUsRUFBQXVHLGNBQXFCdkcsRUFBQXVHLGFBQXJCZSxlQUF3RHRILEVBQUF1RyxhQUFBZSxjQUFnQ3RILEVBQXhGeUcsaUJBRmxCL0IsS0FHVSxXQUFRMUUsRUFBQXVHLGNBQXFCdkcsRUFBQXVHLGFBQXJCcEMsU0FBa0RuRSxFQUFBdUcsYUFBQXBDLFFBQTBCbkUsRUFBNUV5RyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IFBlcnNvbiBmcm9tICcuL3BlcnNvbic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEdW1teUVuZW15IGV4dGVuZHMgUGVyc29uIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWVTdGF0ZSkge1xyXG4gICAgICAgIHN1cGVyKGdhbWVTdGF0ZSwgJy5kdW1teS1lbmVteS1pbWcnKTtcclxuICAgICAgICB0aGlzLndpZHRoID0gMTAwO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gMTI2O1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB7XHJcbiAgICAgICAgICAgIHg6IE1hdGguYWJzKHRoaXMud2lkdGggLSB0aGlzLmdhbWUud2lkdGggKiBNYXRoLnJhbmRvbSgpKSxcclxuICAgICAgICAgICAgeTogdGhpcy5nYW1lLmhlaWdodCAvIDIgKiBNYXRoLnJhbmRvbSgpXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufSIsImltcG9ydCBIZXJvIGZyb20gJy4vaGVybyc7XHJcbmltcG9ydCBEdW1teUVuZW15IGZyb20gJy4vZHVtbXlFbmVteSc7XHJcbmltcG9ydCBGaXJlU3RvcmUgZnJvbSAnLi4vdXRpbHMvZmlyZWJhc2UnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVN0YXRlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMud2lkdGggPSA4MDA7XHJcblx0XHR0aGlzLmhlaWdodCA9IDgwMDtcclxuXHRcdHRoaXMubGV2ZWwgPSAxO1xyXG5cdFx0dGhpcy5iYXNlU3BlZWQgPSAwO1xyXG5cdFx0dGhpcy5jYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdjYW52YXMnKTtcclxuXHRcdHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53aWR0aDtcclxuXHRcdHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuaGVpZ2h0O1xyXG5cclxuXHRcdHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG5cdFx0dGhpcy5jaGFyYWN0ZXJzID0gbmV3IEFycmF5KDIpLmZpbGwoMCkubWFwKCgpID0+IG5ldyBEdW1teUVuZW15KHRoaXMpKTtcclxuXHRcdHRoaXMuaGVybyA9IG5ldyBIZXJvKHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuZ2FtZVBsYXlzID0gZmFsc2U7XHJcblx0XHR0aGlzLnRpbWVySGFuZGxlciA9IDA7XHJcblx0XHR0aGlzLmdhbWVUaW1lciA9IDA7XHJcblx0XHR0aGlzLnNldFVwR2FtZSgpO1xyXG5cdH1cclxuXHJcblx0c2V0VXBHYW1lKCkge1xyXG5cdFx0dGhpcy50aW1lckhhbmRsZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cclxuXHRcdFx0dGhpcy5jaGFyYWN0ZXJzLmZvckVhY2goY2hhcmFjdGVyID0+IHRoaXMuY2hlY2tDaGFyYWN0ZXJzSW50ZXJzZWN0aW9uKHRoaXMuaGVybywgY2hhcmFjdGVyKSk7XHJcblxyXG5cdFx0XHR0aGlzLmRyYXdDaGFyYWN0ZXIodGhpcy5oZXJvKTtcclxuXHRcdFx0dGhpcy5jaGFyYWN0ZXJzLmZvckVhY2goY2hhcmFjdGVyID0+IHRoaXMuZHJhd0NoYXJhY3RlcihjaGFyYWN0ZXIpKTtcclxuXHRcdH0sIDMwKTtcclxuXHR9XHJcblxyXG5cdGRyYXdDaGFyYWN0ZXIoY2hhcmFjdGVyKSB7XHJcblx0XHRpZiAoY2hhcmFjdGVyLmltYWdlT3JpZW50YXRpb24oKSkge1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuc2F2ZSgpO1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuc2NhbGUoLTEsIDEpO1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuZHJhd0ltYWdlKGNoYXJhY3Rlci5nZXROZXh0U3ByaXRlKCksIGNoYXJhY3Rlci5wb3NpdGlvbi54ICogLTEsIGNoYXJhY3Rlci5wb3NpdGlvbi55LCBjaGFyYWN0ZXIud2lkdGggKiAtMSwgY2hhcmFjdGVyLmhlaWdodCk7XHJcblx0XHRcdHRoaXMuY29udGV4dC5yZXN0b3JlKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuZHJhd0ltYWdlKGNoYXJhY3Rlci5nZXROZXh0U3ByaXRlKCksIGNoYXJhY3Rlci5wb3NpdGlvbi54LCBjaGFyYWN0ZXIucG9zaXRpb24ueSwgY2hhcmFjdGVyLndpZHRoLCBjaGFyYWN0ZXIuaGVpZ2h0KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJ1bkdhbWUoKSB7XHJcblx0XHR0aGlzLmdhbWVUaW1lciA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cdFx0dGhpcy5nYW1lUGxheXMgPSB0cnVlO1xyXG5cdFx0dGhpcy5iYXNlU3BlZWQgPSA1O1xyXG5cdH1cclxuXHJcblx0ZW5kR2FtZSgpIHtcclxuXHRcdGNsZWFySW50ZXJ2YWwodGhpcy50aW1lckhhbmRsZXIpO1xyXG5cdFx0dGhpcy5nYW1lUGxheXMgPSBmYWxzZTtcclxuXHRcdHRoaXMuYmFzZVNwZWVkID0gMDtcclxuXHRcdGxldCBzY29yZSA9IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHRoaXMuZ2FtZVRpbWVyKSAvIDEwMDA7XHJcblx0XHRsZXQgbmFtZSA9IHByb21wdChgWW91ciBzY29yZSBpcyAke3Njb3JlfSBzZWNvbmdzLlxcbiBFbnRlciB5b3VyIG5hbWVgLCAnTmluamEnKTtcclxuXHRcdG5hbWUgJiYgRmlyZVN0b3JlLnNhdmVTY29yZSh7XHJcblx0XHRcdG5hbWUsIHNjb3JlXHJcblx0XHR9KTtcclxuXHR9XHJcblx0Y2hlY2tDaGFyYWN0ZXJzSW50ZXJzZWN0aW9uKGhlcm8sIGVuZW15KSB7XHJcblx0XHRsZXQgZGVsdGFYID0gMzA7XHJcblx0XHRsZXQgZGVsdGFZID0gNTtcclxuXHRcdGlmICgoKGhlcm8ucG9zaXRpb24ueCArIGRlbHRhWCA8PSAoZW5lbXkucG9zaXRpb24ueCArIGVuZW15LndpZHRoKSkgJiYgKChoZXJvLnBvc2l0aW9uLnggKyBoZXJvLndpZHRoKSA+PSBlbmVteS5wb3NpdGlvbi54ICsgZGVsdGFYKSkgJiZcclxuXHRcdFx0KChoZXJvLnBvc2l0aW9uLnkgKyBkZWx0YVkgPD0gKGVuZW15LnBvc2l0aW9uLnkgKyBlbmVteS5oZWlnaHQpKSAmJiAoKGhlcm8ucG9zaXRpb24ueSArIGhlcm8uaGVpZ2h0KSA+PSBlbmVteS5wb3NpdGlvbi55ICsgZGVsdGFZKSkpIHtcclxuXHRcdFx0aGVyby5kaWUoKTtcclxuXHRcdFx0dGhpcy5lbmRHYW1lKCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCBQZXJzb24gZnJvbSAnLi9wZXJzb24nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGVybyBleHRlbmRzIFBlcnNvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lU3RhdGUpIHtcclxuICAgICAgICBzdXBlcihnYW1lU3RhdGUsICcuY2F0LWltZycpO1xyXG4gICAgICAgIHRoaXMuc2V0VXBIZXJvKCk7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IDExNTtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IDEwMDtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICB4OiAodGhpcy5nYW1lLndpZHRoIC0gdGhpcy53aWR0aCkgLyAyLFxyXG4gICAgICAgICAgICB5OiB0aGlzLmdhbWUuaGVpZ2h0IC0gdGhpcy5oZWlnaHRcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRVcEhlcm8oKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA8IDM3IHx8IGV2ZW50LmtleUNvZGUgPiA0MCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5nYW1lLmdhbWVQbGF5cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLnJ1bkdhbWUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BlZWQgPSB0aGlzLmdhbWUuYmFzZVNwZWVkICogdGhpcy5nYW1lLmxldmVsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzNykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25BbmdsZSA9IE1hdGguUEk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM4KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbkFuZ2xlID0gTWF0aC5QSSAvIDIgKiAzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzOSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25BbmdsZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDQwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbkFuZ2xlID0gTWF0aC5QSSAvIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGRpZSgpIHtcclxuICAgICAgICB0aGlzLnNwcml0ZXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYXQtZGVhZC1pbWcnKSk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGVyc29uIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWVTdGF0ZSwgc2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLmdhbWUgPSBnYW1lU3RhdGU7XHJcbiAgICAgICAgdGhpcy5kaXJlY3Rpb25BbmdsZSA9IDIgKiBNYXRoLlBJICogTWF0aC5yYW5kb20oKTtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICB4OiAwLFxyXG4gICAgICAgICAgICB5OiAwXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNwcml0ZXMgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcclxuICAgICAgICB0aGlzLnNwZWVkID0gZ2FtZVN0YXRlLmxldmVsICogZ2FtZVN0YXRlLmJhc2VTcGVlZDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRJbWcgPSAwO1xyXG4gICAgfVxyXG4gICAgZ2V0TmV4dFNwcml0ZSgpIHtcclxuICAgICAgICB0aGlzLnN0ZXAoKTtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50SW1nID49IHRoaXMuc3ByaXRlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50SW1nID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3ByaXRlc1t0aGlzLmN1cnJlbnRJbWcrK107XHJcbiAgICB9XHJcbiAgICBzdGVwKCkge1xyXG4gICAgICAgIHRoaXMuc3BlZWQgPSB0aGlzLmdhbWUuYmFzZVNwZWVkICogdGhpcy5nYW1lLmxldmVsO1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueCArPSBNYXRoLmNvcyh0aGlzLmRpcmVjdGlvbkFuZ2xlKSAqIHRoaXMuc3BlZWQ7XHJcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueCArIHRoaXMud2lkdGggLyAyID4gdGhpcy5nYW1lLndpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCA9IC10aGlzLndpZHRoIC8gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueCArIHRoaXMud2lkdGggLyAyIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnggPSB0aGlzLmdhbWUud2lkdGggLSB0aGlzLndpZHRoIC8gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi55ICs9IE1hdGguc2luKHRoaXMuZGlyZWN0aW9uQW5nbGUpICogdGhpcy5zcGVlZDtcclxuICAgICAgICBpZiAodGhpcy5wb3NpdGlvbi55ICsgdGhpcy5oZWlnaHQgLyAyID4gdGhpcy5nYW1lLmhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnkgPSAtdGhpcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5wb3NpdGlvbi55ICsgdGhpcy5oZWlnaHQgLyAyIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnkgPSB0aGlzLmdhbWUuaGVpZ2h0IC0gdGhpcy5oZWlnaHQgLyAyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGltYWdlT3JpZW50YXRpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0aW9uQW5nbGUgPj0gTWF0aC5QSSAvIDIgJiYgdGhpcy5kaXJlY3Rpb25BbmdsZSA8PSBNYXRoLlBJICogMyAvIDI7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJvdXRlciBmcm9tICcuL3V0aWxzL3JvdXRlcic7XHJcbmltcG9ydCByb3V0ZXMgZnJvbSAnLi9yb3V0ZXMnO1xyXG5cclxubmV3IFJvdXRlcihyb3V0ZXMpOyIsImltcG9ydCBHYW1lU3RhdGUgZnJvbSAnLi9nYW1lT2JqZWN0cy9nYW1lU3RhdGUnO1xyXG5pbXBvcnQgZGV0ZWN0TW9iaWxlIGZyb20gJy4vdXRpbHMvZGV0ZWN0TW9iaWxlJztcclxuaW1wb3J0IEZpcmVTdG9yZSBmcm9tICcuL3V0aWxzL2ZpcmViYXNlJztcclxuXHJcbmxldCBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKTtcclxuYWRkQnV0dG9uc0Zvck1vYmlsZSgpO1xyXG5cclxuY29uc3Qgcm91dGVzID0gW1xyXG4gICAge1xyXG4gICAgICAgIG1hdGNoOiAnJyxcclxuICAgICAgICBvbkVudGVyOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJ2dhbWUnO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbWF0Y2g6ICdhYm91dCcsXHJcbiAgICAgICAgb25FbnRlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICBjaGFuZ2VBY3RpdmVQYWdlKCdhYm91dCcpO1xyXG4gICAgICAgICAgICBjb250ZW50LmlubmVySFRNTCA9ICc8aDEgY2xhc3M9XCJhYm91dFwiPjxzcGFuPlN1cGVyIGdhbWUgQ2F0IHZzIE5pbmphczwvc3Bhbj48aDE+JztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG1hdGNoOiAnZ2FtZScsXHJcbiAgICAgICAgb25FbnRlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICBjaGFuZ2VBY3RpdmVQYWdlKCdnYW1lJyk7XHJcbiAgICAgICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChjYW52YXMpO1xyXG4gICAgICAgICAgICBuZXcgR2FtZVN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBtYXRjaDogJ3Njb3JlcycsXHJcbiAgICAgICAgb25FbnRlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICBjaGFuZ2VBY3RpdmVQYWdlKCdzY29yZXMnKTtcclxuXHJcbiAgICAgICAgICAgIEZpcmVTdG9yZS5nZXRTY29yZXMoKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50LmlubmVySFRNTCA9ICc8aDEgY2xhc3M9XCJhYm91dFwiPjxzcGFuPlNjb3Jlczwvc3Bhbj48L2gxPic7XHJcbiAgICAgICAgICAgICAgICBsZXQgb2wgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvbCcpO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgICAgICAgICAgICAgICAgICBsaS5pbm5lckhUTUwgPSBgJHtpdGVtLm5hbWV9IC0gJHtpdGVtLnNjb3JlfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgb2wuYXBwZW5kQ2hpbGQobGkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGRpdkZvckRpdmlzaW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBkaXZGb3JEaXZpc2lvbi5jbGFzc0xpc3QuYWRkKCd3LTEwMCcpO1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChkaXZGb3JEaXZpc2lvbik7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQob2wpO1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5dO1xyXG5cclxuZnVuY3Rpb24gY2hhbmdlQWN0aXZlUGFnZShuZXdQYWdlKSB7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWN0aXZlJykuY2xhc3NOYW1lID0gJyc7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbaHJlZj1cIiMke25ld1BhZ2V9XCJdYCkucGFyZW50RWxlbWVudC5jbGFzc05hbWUgPSAnYWN0aXZlJztcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkQnV0dG9uc0Zvck1vYmlsZSgpIHtcclxuICAgIGlmIChkZXRlY3RNb2JpbGUoKSkge1xyXG5cclxuICAgICAgICB2YXIgZGl2Rm9yQnV0dG9ucyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGRpdkZvckJ1dHRvbnMuY2xhc3NMaXN0LmFkZCgnYnV0dG9ucycpO1xyXG5cclxuICAgICAgICB2YXIgYnV0dG9uTGVmdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGJ1dHRvbkxlZnQuaW5uZXJIVE1MID0gJzwnO1xyXG4gICAgICAgIGJ1dHRvbkxlZnQuY2xhc3NMaXN0LmFkZCgnbGVmdCcpO1xyXG5cclxuICAgICAgICB2YXIgYnV0dG9uVXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBidXR0b25VcC5pbm5lckhUTUwgPSAnXic7XHJcbiAgICAgICAgYnV0dG9uVXAuY2xhc3NMaXN0LmFkZCgndXAnKTtcclxuXHJcbiAgICAgICAgdmFyIGJ1dHRvblJpZ2h0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgYnV0dG9uUmlnaHQuaW5uZXJIVE1MID0gJz4nO1xyXG4gICAgICAgIGJ1dHRvblJpZ2h0LmNsYXNzTGlzdC5hZGQoJ3JpZ2h0Jyk7XHJcblxyXG4gICAgICAgIHZhciBidXR0b25Eb3duID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgYnV0dG9uRG93bi5pbm5lckhUTUwgPSAndic7XHJcbiAgICAgICAgYnV0dG9uRG93bi5jbGFzc0xpc3QuYWRkKCdkb3duJyk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgZGl2Rm9yQnV0dG9ucy5hcHBlbmRDaGlsZChidXR0b25MZWZ0KTtcclxuICAgICAgICBkaXZGb3JCdXR0b25zLmFwcGVuZENoaWxkKGJ1dHRvblVwKTtcclxuICAgICAgICBkaXZGb3JCdXR0b25zLmFwcGVuZENoaWxkKGJ1dHRvblJpZ2h0KTtcclxuICAgICAgICBkaXZGb3JCdXR0b25zLmFwcGVuZENoaWxkKGJ1dHRvbkRvd24pO1xyXG5cclxuICAgICAgICBkaXZGb3JCdXR0b25zLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQubWF0Y2hlcygnLnJpZ2h0JykpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gbmV3IEV2ZW50KCdrZXlkb3duJyk7XHJcbiAgICAgICAgICAgICAgICBlLmtleUNvZGUgPSAzOTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5tYXRjaGVzKCcubGVmdCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IG5ldyBFdmVudCgna2V5ZG93bicpO1xyXG4gICAgICAgICAgICAgICAgZS5rZXlDb2RlID0gMzc7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQubWF0Y2hlcygnLnVwJykpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gbmV3IEV2ZW50KCdrZXlkb3duJyk7XHJcbiAgICAgICAgICAgICAgICBlLmtleUNvZGUgPSAzODtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5tYXRjaGVzKCcuZG93bicpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IG5ldyBFdmVudCgna2V5ZG93bicpO1xyXG4gICAgICAgICAgICAgICAgZS5rZXlDb2RlID0gNDA7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2Rm9yQnV0dG9ucyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJvdXRlcztcclxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGV0ZWN0bW9iaWxlKCkge1xyXG4gICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSlcclxuICAgICAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC93ZWJPUy9pKVxyXG4gICAgICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQaG9uZS9pKVxyXG4gICAgICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSlcclxuICAgICAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUG9kL2kpXHJcbiAgICAgICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQmxhY2tCZXJyeS9pKVxyXG4gICAgICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1dpbmRvd3MgUGhvbmUvaSlcclxuICAgICkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59IiwibGV0IHVybCA9ICdodHRwczovL2thdGUtYXJjYWRlLWdhbWUuZmlyZWJhc2Vpby5jb20vLmpzb24nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlyZVN0b3JlIHtcclxuICAgIHN0YXRpYyBnZXRTY29yZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHVybCArICc/cHJpbnQ9cHJldHR5JykudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgbGV0IGFycmF5UmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiByZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGFycmF5UmVzdWx0LnB1c2gocmVzdWx0W2tleV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBhcnJheVJlc3VsdC5zb3J0KChpdGVtMSwgaXRlbTIpID0+IGl0ZW0xLnNjb3JlID4gaXRlbTIuc2NvcmUgPyAtMSA6IGl0ZW0xLnNjb3JlIDwgaXRlbTIuc2NvcmUgPyAxIDogMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgc2F2ZVNjb3JlKGluZm9Ub1NhdmUpIHtcclxuICAgICAgICBmZXRjaCh1cmwsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGluZm9Ub1NhdmUpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCIvKipcclxuICog0KTRg9C90LrRhtC40Y8g0LTQu9GPINC00L7QsdCw0LLQu9C10L3QuNGPINC4INC+0LHRgNCw0LHQvtGC0LrQuCDRgNC+0YPRgtC+0LIg0L3QsCDRgdGC0YDQsNC90LjRhtC1XHJcbiAqIEBwYXJhbSB7Kn0gcm91dGVQYXJhbXMg0LzQsNGB0YHQuNCyINC/0LDRgNCw0LzQtdGC0YDQvtCyINC00LvRjyDQvtCx0YDQsNCx0L7RgtC60Lgg0YDQvtGD0YLQvtCyXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBSb3V0ZXIocm91dGVQYXJhbXMpIHtcclxuICAgIHRoaXMucm91dGVzID0gcm91dGVQYXJhbXMgfHwgW107XHJcbiAgICB0aGlzLmN1cnJlbnRSb3V0ZTtcclxuICAgIHRoaXMucHJldmlvdXNSb3V0ZTtcclxuICAgIHRoaXMuY3VycmVudFBhcmFtcztcclxuICAgIHRoaXMucHJldmlvdXNQYXJhbXM7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsICgpID0+IHtcclxuICAgICAgICB0aGlzLmhhbmRsZXIod2luZG93LmxvY2F0aW9uLmhhc2gpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmhhbmRsZXIod2luZG93LmxvY2F0aW9uLmhhc2gpO1xyXG59XHJcblxyXG5Sb3V0ZXIucHJvdG90eXBlID0ge1xyXG4gICAgaGFuZGxlcjogZnVuY3Rpb24gKGhhc2gpIHtcclxuICAgICAgICB0aGlzLnByZXZpb3VzUm91dGUgPSB0aGlzLmN1cnJlbnRSb3V0ZTtcclxuICAgICAgICB0aGlzLnByZXZpb3VzUGFyYW1zID0gdGhpcy5jdXJyZW50UGFyYW1zO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFJvdXRlID0gdGhpcy5maW5kTmV3Um91dGUoaGFzaCk7XHJcbiAgICAgICAgdGhpcy5sYXVuY2hIYW5kbGVycygpO1xyXG4gICAgfSxcclxuICAgIGZpbmROZXdSb3V0ZTogZnVuY3Rpb24gKGhhc2gpIHtcclxuICAgICAgICBoYXNoID0gaGFzaC5zbGljZSgxKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnJvdXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMucm91dGVzW2ldO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIChlbGVtZW50Lm1hdGNoKSA9PSAnc3RyaW5nJyAmJiBlbGVtZW50Lm1hdGNoID09PSBoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXJhbXMgPSAnJztcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKGVsZW1lbnQubWF0Y2gpID09ICdmdW5jdGlvbicgJiYgZWxlbWVudC5tYXRjaChoYXNoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gJyc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoKGVsZW1lbnQubWF0Y2ggaW5zdGFuY2VvZiBSZWdFeHApICYmIGVsZW1lbnQubWF0Y2gudGVzdChoYXNoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gaGFzaC5tYXRjaChlbGVtZW50Lm1hdGNoKSB8fCBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhcmFtcy5zcGxpY2UoMCwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBsYXVuY2hIYW5kbGVycygpIHtcclxuICAgICAgICBQcm9taXNlLnJlc29sdmUoKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7IHRoaXMucHJldmlvdXNSb3V0ZSAmJiB0aGlzLnByZXZpb3VzUm91dGUub25MZWF2ZSAmJiB0aGlzLnByZXZpb3VzUm91dGUub25MZWF2ZSh0aGlzLnByZXZpb3VzUGFyYW1zKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB0aGlzLmN1cnJlbnRSb3V0ZSAmJiB0aGlzLmN1cnJlbnRSb3V0ZS5vbkJlZm9yZUVudGVyICYmIHRoaXMuY3VycmVudFJvdXRlLm9uQmVmb3JlRW50ZXIodGhpcy5jdXJyZW50UGFyYW1zKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB0aGlzLmN1cnJlbnRSb3V0ZSAmJiB0aGlzLmN1cnJlbnRSb3V0ZS5vbkVudGVyICYmIHRoaXMuY3VycmVudFJvdXRlLm9uRW50ZXIodGhpcy5jdXJyZW50UGFyYW1zKTsgfSk7XHJcbiAgICB9XHJcbn07Il19
