!function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[t]={exports:{}};a[t][0].call(r.exports,function(e){return c(a[t][1][e]||e)},r,r.exports,o,a,s,u)}return s[t].exports}for(var h="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var r,o=e("./person"),a=(r=o)&&r.__esModule?r:{default:r};var s=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":i(t))&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,".dummy-enemy-img",!1));return t.width=100,t.height=126,t.position={x:t.game.width*Math.random(),y:t.game.height/2*Math.random()},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a.default),n}();n.default=s},{"./person":4}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=a(e("./hero")),o=a(e("./dummyEnemy"));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=800,this.height=800,this.level=1,this.baseSpeed=0,this.canvas=document.querySelector("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.characters=new Array(2).fill(0).map(function(){return new o.default(e)}),this.characters.push(new r.default(this)),this.gamePlays=!1,this.setUpGame(),this.timer=0}return i(t,[{key:"setUpGame",value:function(){var t=this;this.timer=setInterval(function(){t.context.clearRect(0,0,t.width,t.height),t.characters.forEach(function(e){return t.drawCharacter(e)})},30)}},{key:"drawCharacter",value:function(e){e.imageOrientation()?(this.context.save(),this.context.scale(-1,1),this.context.drawImage(e.getNextSprite(),-1*e.position.x,e.position.y,-1*e.width,e.height),this.context.restore()):this.context.drawImage(e.getNextSprite(),e.position.x,e.position.y,e.width,e.height)}},{key:"runGame",value:function(){this.gamePlays=!0,this.baseSpeed=5}},{key:"pauseGame",value:function(){this.gamePlays=!1,this.baseSpeed=0,clearInterval(this.timer)}}]),t}();n.default=s},{"./dummyEnemy":1,"./hero":3}],3:[function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var r,o=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=e("./person"),s=(r=a)&&r.__esModule?r:{default:r};var u=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":i(t))&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,".cat-img"));return t.setUpHero(),t.width=115,t.height=100,t.position={x:(t.game.width-t.width)/2,y:t.game.height-t.height},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":i(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,s.default),o(n,[{key:"setUpHero",value:function(){var t=this;document.addEventListener("keydown",function(e){t.game.gamePlays||(t.game.runGame(),t.speed=t.game.baseSpeed*t.game.level),37===e.keyCode&&(t.directionAngle=Math.PI),38===e.keyCode&&(t.directionAngle=Math.PI/2*3),39===e.keyCode&&(t.directionAngle=0),40===e.keyCode&&(t.directionAngle=Math.PI/2)})}}]),n}();n.default=u},{"./person":4}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var i=function(){function i(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.mainHero=n,this.game=e,this.directionAngle=this.mainHero?0:2*Math.PI*Math.random(),this.position={x:0,y:0},this.sprites=[].slice.call(document.querySelectorAll(t)),this.speed=e.level*e.baseSpeed,this.currentImg=0}return r(i,[{key:"getNextSprite",value:function(){return this.step(),this.currentImg>=this.sprites.length&&(this.currentImg=0),this.sprites[this.currentImg++]}},{key:"step",value:function(){this.speed=this.game.baseSpeed*this.game.level,this.position.x+=Math.cos(this.directionAngle)*this.speed,this.position.x+this.width/2>this.game.width&&(this.position.x=-this.width/2),this.position.x+this.width/2<0&&(this.position.x=this.game.width-this.width/2),this.position.y+=Math.sin(this.directionAngle)*this.speed,this.position.y+this.height/2>this.game.height&&(this.position.y=-this.height/2),this.position.y+this.height/2<0&&(this.position.y=this.game.height-this.height/2)}},{key:"imageOrientation",value:function(){return this.directionAngle>=Math.PI/2&&this.directionAngle<=3*Math.PI/2}}]),i}();n.default=i},{}],5:[function(e,t,n){"use strict";var i=o(e("./utils/router")),r=o(e("./routes"));function o(e){return e&&e.__esModule?e:{default:e}}new i.default(r.default)},{"./routes":6,"./utils/router":8}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("./gameObjects/gameState")),o=r(e("./utils/detectMobile"));function r(e){return e&&e.__esModule?e:{default:e}}var a=document.querySelector(".content");!function(){if((0,o.default)()){var e=document.createElement("div");e.classList.add("buttons");var t=document.createElement("button");t.innerHTML="<",t.classList.add("left");var n=document.createElement("button");n.innerHTML="^",n.classList.add("up");var i=document.createElement("button");i.innerHTML=">",i.classList.add("right");var r=document.createElement("button");r.innerHTML="v",r.classList.add("down"),e.appendChild(t),e.appendChild(n),e.appendChild(i),e.appendChild(r),e.addEventListener("click",function(e){if(e.target.matches(".right")){var t=new Event("keydown");return t.keyCode=39,void document.dispatchEvent(t)}if(e.target.matches(".left")){var n=new Event("keydown");return n.keyCode=37,void document.dispatchEvent(n)}if(e.target.matches(".up")){var i=new Event("keydown");return i.keyCode=38,void document.dispatchEvent(i)}if(e.target.matches(".down")){var r=new Event("keydown");return r.keyCode=40,void document.dispatchEvent(r)}}),document.body.appendChild(e)}}();var s=[{match:"",onEnter:function(){window.location.hash="game"}},{match:"about",onEnter:function(){u("about"),a.innerHTML='<h1 class="about"><span>Super game Cat vs Ninjas</span><h1>'}},{match:"game",onEnter:function(){u("game");var e=document.createElement("canvas");a.innerHTML="",a.appendChild(e),new i.default}},{match:"scores",onEnter:function(){u("scores"),a.innerHTML='<h1 class="about"><span>Scores</span><h1>'}}];function u(e){document.querySelector(".active").className="",document.querySelector('[href="#'+e+'"]').parentElement.className="active"}n.default=s},{"./gameObjects/gameState":2,"./utils/detectMobile":7}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}},{}],8:[function(e,t,n){"use strict";function i(e){var t=this;this.routes=e||[],this.currentRoute,this.previousRoute,this.currentParams,this.previousParams,window.addEventListener("hashchange",function(){t.handler(window.location.hash)}),this.handler(window.location.hash)}Object.defineProperty(n,"__esModule",{value:!0}),(n.default=i).prototype={handler:function(e){this.previousRoute=this.currentRoute,this.previousParams=this.currentParams,this.currentRoute=this.findNewRoute(e),this.launchHandlers()},findNewRoute:function(e){e=e.slice(1);for(var t=0;t<this.routes.length;t++){var n=this.routes[t];if("string"==typeof n.match&&n.match===e)return this.currentParams="",n;if("function"==typeof n.match&&n.match(e))return this.currentParams="",n;if(n.match instanceof RegExp&&n.match.test(e))return this.currentParams=e.match(n.match)||[],this.currentParams.splice(0,1),n}},launchHandlers:function(){var e=this;Promise.resolve().then(function(){e.previousRoute&&e.previousRoute.onLeave&&e.previousRoute.onLeave(e.previousParams)}).then(function(){e.currentRoute&&e.currentRoute.onBeforeEnter&&e.currentRoute.onBeforeEnter(e.currentParams)}).then(function(){e.currentRoute&&e.currentRoute.onEnter&&e.currentRoute.onEnter(e.currentParams)})}}},{}]},{},[5]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZ2FtZU9iamVjdHMvZHVtbXlFbmVteS5qcyIsInNyYy9qcy9nYW1lT2JqZWN0cy9nYW1lU3RhdGUuanMiLCJzcmMvanMvZ2FtZU9iamVjdHMvaGVyby5qcyIsInNyYy9qcy9nYW1lT2JqZWN0cy9wZXJzb24uanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9yb3V0ZXMuanMiLCJzcmMvanMvdXRpbHMvZGV0ZWN0TW9iaWxlLmpzIiwic3JjL2pzL3V0aWxzL3JvdXRlci5qcyJdLCJuYW1lcyI6WyJyIiwiZSIsIm4iLCJ0IiwibyIsImkiLCJmIiwiYyIsInJlcXVpcmUiLCJ1IiwiYSIsIkVycm9yIiwiY29kZSIsInAiLCJleHBvcnRzIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJtb2R1bGUiLCJfcGVyc29uIiwiRHVtbXlFbmVteSIsImdhbWVTdGF0ZSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfdGhpcyIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiX19wcm90b19fIiwiT2JqZWN0IiwiZ2V0UHJvdG90eXBlT2YiLCJ3aWR0aCIsImhlaWdodCIsInBvc2l0aW9uIiwieCIsImdhbWUiLCJNYXRoIiwicmFuZG9tIiwieSIsIl9wZXJzb24yIiwiZGVmYXVsdCIsIkdhbWVTdGF0ZSIsImxldmVsIiwiYmFzZVNwZWVkIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGV4dCIsImdldENvbnRleHQiLCJjaGFyYWN0ZXJzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiX2R1bW15RW5lbXkyIiwicHVzaCIsIl9oZXJvMiIsImdhbWVQbGF5cyIsInNldFVwR2FtZSIsInRpbWVyIiwiX3RoaXMyIiwic2V0SW50ZXJ2YWwiLCJjbGVhclJlY3QiLCJmb3JFYWNoIiwiY2hhcmFjdGVyIiwiZHJhd0NoYXJhY3RlciIsImltYWdlT3JpZW50YXRpb24iLCJzYXZlIiwic2NhbGUiLCJkcmF3SW1hZ2UiLCJnZXROZXh0U3ByaXRlIiwicmVzdG9yZSIsImNsZWFySW50ZXJ2YWwiLCJIZXJvIiwic2V0VXBIZXJvIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicnVuR2FtZSIsInNwZWVkIiwia2V5Q29kZSIsImRpcmVjdGlvbkFuZ2xlIiwiUEkiLCJQZXJzb24iLCJzZWxlY3RvciIsIm1haW5IZXJvIiwic3ByaXRlcyIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsImN1cnJlbnRJbWciLCJzdGVwIiwiY29zIiwic2luIiwiX3JvdXRlcjIiLCJfcm91dGVzMiIsImNvbnRlbnQiLCJfZGV0ZWN0TW9iaWxlMiIsImRpdkZvckJ1dHRvbnMiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYnV0dG9uTGVmdCIsImlubmVySFRNTCIsImJ1dHRvblVwIiwiYnV0dG9uUmlnaHQiLCJidXR0b25Eb3duIiwiYXBwZW5kQ2hpbGQiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwiX2UiLCJfZTIiLCJfZTMiLCJib2R5IiwiYWRkQnV0dG9uc0Zvck1vYmlsZSIsInJvdXRlcyIsIm1hdGNoIiwib25FbnRlciIsIndpbmRvdyIsImxvY2F0aW9uIiwiaGFzaCIsImNoYW5nZUFjdGl2ZVBhZ2UiLCJfZ2FtZVN0YXRlMiIsIm5ld1BhZ2UiLCJjbGFzc05hbWUiLCJwYXJlbnRFbGVtZW50IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiUm91dGVyIiwicm91dGVQYXJhbXMiLCJjdXJyZW50Um91dGUiLCJwcmV2aW91c1JvdXRlIiwiY3VycmVudFBhcmFtcyIsInByZXZpb3VzUGFyYW1zIiwiaGFuZGxlciIsInByb3RvdHlwZSIsImZpbmROZXdSb3V0ZSIsImxhdW5jaEhhbmRsZXJzIiwiZWxlbWVudCIsIlJlZ0V4cCIsInRlc3QiLCJzcGxpY2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJvbkxlYXZlIiwib25CZWZvcmVF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ckYsRUFBQXVFLGNBQUFjLFFBQTJCckYsRUFBL0V5RSxrQkFEbEJXLEtBRVUsV0FBUXBGLEVBQUFzRSxjQUFxQnRFLEVBQUFzRSxhQUFyQmdCLGVBQXdEdEYsRUFBQXNFLGFBQUFnQixjQUFnQ3RGLEVBQXhGd0UsaUJBRmxCWSxLQUdVLFdBQVFwRixFQUFBc0UsY0FBcUJ0RSxFQUFBc0UsYUFBckJiLFNBQWtEekQsRUFBQXNFLGFBQUFiLFFBQTBCekQsRUFBNUV3RSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IFBlcnNvbiBmcm9tICcuL3BlcnNvbic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEdW1teUVuZW15IGV4dGVuZHMgUGVyc29uIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWVTdGF0ZSkge1xyXG4gICAgICAgIHN1cGVyKGdhbWVTdGF0ZSwgJy5kdW1teS1lbmVteS1pbWcnLCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IDEwMDtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IDEyNjtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICB4OiB0aGlzLmdhbWUud2lkdGggKiBNYXRoLnJhbmRvbSgpLFxyXG4gICAgICAgICAgICB5OiB0aGlzLmdhbWUuaGVpZ2h0IC8gMiAqIE1hdGgucmFuZG9tKClcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEhlcm8gZnJvbSAnLi9oZXJvJztcclxuaW1wb3J0IER1bW15RW5lbXkgZnJvbSAnLi9kdW1teUVuZW15JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVTdGF0ZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHR0aGlzLndpZHRoID0gODAwO1xyXG5cdFx0dGhpcy5oZWlnaHQgPSA4MDA7XHJcblx0XHR0aGlzLmxldmVsID0gMTtcclxuXHRcdHRoaXMuYmFzZVNwZWVkID0gMDtcclxuXHRcdHRoaXMuY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7XHJcblx0XHR0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMud2lkdGg7XHJcblx0XHR0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmhlaWdodDtcclxuXHJcblx0XHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuXHRcdHRoaXMuY2hhcmFjdGVycyA9IG5ldyBBcnJheSgyKS5maWxsKDApLm1hcCgoKSA9PiBuZXcgRHVtbXlFbmVteSh0aGlzKSk7XHJcblx0XHR0aGlzLmNoYXJhY3RlcnMucHVzaChuZXcgSGVybyh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy5nYW1lUGxheXMgPSBmYWxzZTtcclxuXHRcdHRoaXMuc2V0VXBHYW1lKCk7XHJcblx0XHR0aGlzLnRpbWVyID0gMDtcclxuXHR9XHJcblxyXG5cdHNldFVwR2FtZSgpIHtcclxuXHRcdHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdFx0XHR0aGlzLmNoYXJhY3RlcnMuZm9yRWFjaChjaGFyYWN0ZXIgPT4gdGhpcy5kcmF3Q2hhcmFjdGVyKGNoYXJhY3RlcikpO1xyXG5cdFx0fSwgMzApO1xyXG5cdH1cclxuXHJcblx0ZHJhd0NoYXJhY3RlcihjaGFyYWN0ZXIpIHtcclxuXHRcdGlmIChjaGFyYWN0ZXIuaW1hZ2VPcmllbnRhdGlvbigpKSB7XHJcblx0XHRcdHRoaXMuY29udGV4dC5zYXZlKCk7XHJcblx0XHRcdHRoaXMuY29udGV4dC5zY2FsZSgtMSwgMSk7XHJcblx0XHRcdHRoaXMuY29udGV4dC5kcmF3SW1hZ2UoY2hhcmFjdGVyLmdldE5leHRTcHJpdGUoKSwgY2hhcmFjdGVyLnBvc2l0aW9uLnggKiAtMSwgY2hhcmFjdGVyLnBvc2l0aW9uLnksIGNoYXJhY3Rlci53aWR0aCAqIC0xLCBjaGFyYWN0ZXIuaGVpZ2h0KTtcclxuXHRcdFx0dGhpcy5jb250ZXh0LnJlc3RvcmUoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuY29udGV4dC5kcmF3SW1hZ2UoY2hhcmFjdGVyLmdldE5leHRTcHJpdGUoKSwgY2hhcmFjdGVyLnBvc2l0aW9uLngsIGNoYXJhY3Rlci5wb3NpdGlvbi55LCBjaGFyYWN0ZXIud2lkdGgsIGNoYXJhY3Rlci5oZWlnaHQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cnVuR2FtZSgpIHtcclxuXHRcdHRoaXMuZ2FtZVBsYXlzID0gdHJ1ZTtcclxuXHRcdHRoaXMuYmFzZVNwZWVkID0gNTtcclxuXHR9XHJcblx0cGF1c2VHYW1lKCkge1xyXG5cdFx0dGhpcy5nYW1lUGxheXMgPSBmYWxzZTtcclxuXHRcdHRoaXMuYmFzZVNwZWVkID0gMDtcclxuXHRcdGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCBQZXJzb24gZnJvbSAnLi9wZXJzb24nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGVybyBleHRlbmRzIFBlcnNvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lU3RhdGUpIHtcclxuICAgICAgICBzdXBlcihnYW1lU3RhdGUsICcuY2F0LWltZycpO1xyXG4gICAgICAgIHRoaXMuc2V0VXBIZXJvKCk7XHJcbiAgICAgICAgdGhpcy53aWR0aCA9IDExNTtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IDEwMDtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0ge1xyXG4gICAgICAgICAgICB4OiAodGhpcy5nYW1lLndpZHRoIC0gdGhpcy53aWR0aCkgLyAyLFxyXG4gICAgICAgICAgICB5OiB0aGlzLmdhbWUuaGVpZ2h0IC0gdGhpcy5oZWlnaHRcclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRVcEhlcm8oKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2FtZS5nYW1lUGxheXMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5ydW5HYW1lKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5nYW1lLmJhc2VTcGVlZCAqIHRoaXMuZ2FtZS5sZXZlbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uQW5nbGUgPSBNYXRoLlBJO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzOCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25BbmdsZSA9IE1hdGguUEkgLyAyICogMztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uQW5nbGUgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSA0MCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb25BbmdsZSA9IE1hdGguUEkgLyAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGVyc29uIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWVTdGF0ZSwgc2VsZWN0b3IsIG1haW5IZXJvKSB7XHJcbiAgICAgICAgdGhpcy5tYWluSGVybyA9IG1haW5IZXJvO1xyXG4gICAgICAgIHRoaXMuZ2FtZSA9IGdhbWVTdGF0ZTtcclxuICAgICAgICB0aGlzLmRpcmVjdGlvbkFuZ2xlID0gdGhpcy5tYWluSGVybyA/IDAgOiAyICogTWF0aC5QSSAqIE1hdGgucmFuZG9tKCk7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgeDogMCxcclxuICAgICAgICAgICAgeTogMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zcHJpdGVzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XHJcbiAgICAgICAgdGhpcy5zcGVlZCA9IGdhbWVTdGF0ZS5sZXZlbCAqIGdhbWVTdGF0ZS5iYXNlU3BlZWQ7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SW1nID0gMDtcclxuICAgIH1cclxuICAgIGdldE5leHRTcHJpdGUoKSB7XHJcbiAgICAgICAgdGhpcy5zdGVwKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEltZyA+PSB0aGlzLnNwcml0ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEltZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNwcml0ZXNbdGhpcy5jdXJyZW50SW1nKytdO1xyXG4gICAgfVxyXG4gICAgc3RlcCgpIHtcclxuICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5nYW1lLmJhc2VTcGVlZCAqIHRoaXMuZ2FtZS5sZXZlbDtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnggKz0gTWF0aC5jb3ModGhpcy5kaXJlY3Rpb25BbmdsZSkgKiB0aGlzLnNwZWVkO1xyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnggKyB0aGlzLndpZHRoIC8gMiA+IHRoaXMuZ2FtZS53aWR0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnggPSAtdGhpcy53aWR0aCAvIDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnggKyB0aGlzLndpZHRoIC8gMiA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi54ID0gdGhpcy5nYW1lLndpZHRoIC0gdGhpcy53aWR0aCAvIDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueSArPSBNYXRoLnNpbih0aGlzLmRpcmVjdGlvbkFuZ2xlKSAqIHRoaXMuc3BlZWQ7XHJcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueSArIHRoaXMuaGVpZ2h0IC8gMiA+IHRoaXMuZ2FtZS5oZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi55ID0gLXRoaXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueSArIHRoaXMuaGVpZ2h0IC8gMiA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi55ID0gdGhpcy5nYW1lLmhlaWdodCAtIHRoaXMuaGVpZ2h0IC8gMjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpbWFnZU9yaWVudGF0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGlvbkFuZ2xlID49IE1hdGguUEkgLyAyICYmIHRoaXMuZGlyZWN0aW9uQW5nbGUgPD0gTWF0aC5QSSAqIDMgLyAyO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBSb3V0ZXIgZnJvbSAnLi91dGlscy9yb3V0ZXInO1xyXG5pbXBvcnQgcm91dGVzIGZyb20gJy4vcm91dGVzJztcclxuXHJcbm5ldyBSb3V0ZXIocm91dGVzKTsiLCJpbXBvcnQgR2FtZVN0YXRlIGZyb20gJy4vZ2FtZU9iamVjdHMvZ2FtZVN0YXRlJztcclxuaW1wb3J0IGRldGVjdE1vYmlsZSBmcm9tICcuL3V0aWxzL2RldGVjdE1vYmlsZSc7XHJcblxyXG5sZXQgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50Jyk7XHJcbmFkZEJ1dHRvbnNGb3JNb2JpbGUoKTtcclxuXHJcbmNvbnN0IHJvdXRlcyA9IFtcclxuICAgIHtcclxuICAgICAgICBtYXRjaDogJycsXHJcbiAgICAgICAgb25FbnRlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICdnYW1lJztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG1hdGNoOiAnYWJvdXQnLFxyXG4gICAgICAgIG9uRW50ZXI6ICgpID0+IHtcclxuICAgICAgICAgICAgY2hhbmdlQWN0aXZlUGFnZSgnYWJvdXQnKTtcclxuICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAnPGgxIGNsYXNzPVwiYWJvdXRcIj48c3Bhbj5TdXBlciBnYW1lIENhdCB2cyBOaW5qYXM8L3NwYW4+PGgxPic7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBtYXRjaDogJ2dhbWUnLFxyXG4gICAgICAgIG9uRW50ZXI6ICgpID0+IHtcclxuICAgICAgICAgICAgY2hhbmdlQWN0aXZlUGFnZSgnZ2FtZScpO1xyXG4gICAgICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgICAgICAgICAgbmV3IEdhbWVTdGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbWF0Y2g6ICdzY29yZXMnLFxyXG4gICAgICAgIG9uRW50ZXI6ICgpID0+IHtcclxuICAgICAgICAgICAgY2hhbmdlQWN0aXZlUGFnZSgnc2NvcmVzJyk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gJzxoMSBjbGFzcz1cImFib3V0XCI+PHNwYW4+U2NvcmVzPC9zcGFuPjxoMT4nO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbl07XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VBY3RpdmVQYWdlKG5ld1BhZ2UpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUnKS5jbGFzc05hbWUgPSAnJztcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtocmVmPVwiIyR7bmV3UGFnZX1cIl1gKS5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZSA9ICdhY3RpdmUnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRCdXR0b25zRm9yTW9iaWxlKCkge1xyXG4gICAgaWYgKGRldGVjdE1vYmlsZSgpKSB7XHJcblxyXG4gICAgICAgIHZhciBkaXZGb3JCdXR0b25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgZGl2Rm9yQnV0dG9ucy5jbGFzc0xpc3QuYWRkKCdidXR0b25zJyk7XHJcblxyXG4gICAgICAgIHZhciBidXR0b25MZWZ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgYnV0dG9uTGVmdC5pbm5lckhUTUwgPSAnPCc7XHJcbiAgICAgICAgYnV0dG9uTGVmdC5jbGFzc0xpc3QuYWRkKCdsZWZ0Jyk7XHJcblxyXG4gICAgICAgIHZhciBidXR0b25VcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGJ1dHRvblVwLmlubmVySFRNTCA9ICdeJztcclxuICAgICAgICBidXR0b25VcC5jbGFzc0xpc3QuYWRkKCd1cCcpO1xyXG5cclxuICAgICAgICB2YXIgYnV0dG9uUmlnaHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBidXR0b25SaWdodC5pbm5lckhUTUwgPSAnPic7XHJcbiAgICAgICAgYnV0dG9uUmlnaHQuY2xhc3NMaXN0LmFkZCgncmlnaHQnKTtcclxuXHJcbiAgICAgICAgdmFyIGJ1dHRvbkRvd24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBidXR0b25Eb3duLmlubmVySFRNTCA9ICd2JztcclxuICAgICAgICBidXR0b25Eb3duLmNsYXNzTGlzdC5hZGQoJ2Rvd24nKTtcclxuXHJcblxyXG5cclxuICAgICAgICBkaXZGb3JCdXR0b25zLmFwcGVuZENoaWxkKGJ1dHRvbkxlZnQpO1xyXG4gICAgICAgIGRpdkZvckJ1dHRvbnMuYXBwZW5kQ2hpbGQoYnV0dG9uVXApO1xyXG4gICAgICAgIGRpdkZvckJ1dHRvbnMuYXBwZW5kQ2hpbGQoYnV0dG9uUmlnaHQpO1xyXG4gICAgICAgIGRpdkZvckJ1dHRvbnMuYXBwZW5kQ2hpbGQoYnV0dG9uRG93bik7XHJcblxyXG4gICAgICAgIGRpdkZvckJ1dHRvbnMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5tYXRjaGVzKCcucmlnaHQnKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBuZXcgRXZlbnQoJ2tleWRvd24nKTtcclxuICAgICAgICAgICAgICAgIGUua2V5Q29kZSA9IDM5O1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm1hdGNoZXMoJy5sZWZ0JykpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gbmV3IEV2ZW50KCdrZXlkb3duJyk7XHJcbiAgICAgICAgICAgICAgICBlLmtleUNvZGUgPSAzNztcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5tYXRjaGVzKCcudXAnKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBuZXcgRXZlbnQoJ2tleWRvd24nKTtcclxuICAgICAgICAgICAgICAgIGUua2V5Q29kZSA9IDM4O1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm1hdGNoZXMoJy5kb3duJykpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gbmV3IEV2ZW50KCdrZXlkb3duJyk7XHJcbiAgICAgICAgICAgICAgICBlLmtleUNvZGUgPSA0MDtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXZGb3JCdXR0b25zKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcm91dGVzO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBkZXRlY3Rtb2JpbGUoKSB7XHJcbiAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKVxyXG4gICAgICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL3dlYk9TL2kpXHJcbiAgICAgICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpXHJcbiAgICAgICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKVxyXG4gICAgICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQb2QvaSlcclxuICAgICAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9CbGFja0JlcnJ5L2kpXHJcbiAgICAgICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvV2luZG93cyBQaG9uZS9pKVxyXG4gICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn0iLCIvKipcclxuICog0KTRg9C90LrRhtC40Y8g0LTQu9GPINC00L7QsdCw0LLQu9C10L3QuNGPINC4INC+0LHRgNCw0LHQvtGC0LrQuCDRgNC+0YPRgtC+0LIg0L3QsCDRgdGC0YDQsNC90LjRhtC1XHJcbiAqIEBwYXJhbSB7Kn0gcm91dGVQYXJhbXMg0LzQsNGB0YHQuNCyINC/0LDRgNCw0LzQtdGC0YDQvtCyINC00LvRjyDQvtCx0YDQsNCx0L7RgtC60Lgg0YDQvtGD0YLQvtCyXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBSb3V0ZXIocm91dGVQYXJhbXMpIHtcclxuICAgIHRoaXMucm91dGVzID0gcm91dGVQYXJhbXMgfHwgW107XHJcbiAgICB0aGlzLmN1cnJlbnRSb3V0ZTtcclxuICAgIHRoaXMucHJldmlvdXNSb3V0ZTtcclxuICAgIHRoaXMuY3VycmVudFBhcmFtcztcclxuICAgIHRoaXMucHJldmlvdXNQYXJhbXM7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsICgpID0+IHtcclxuICAgICAgICB0aGlzLmhhbmRsZXIod2luZG93LmxvY2F0aW9uLmhhc2gpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmhhbmRsZXIod2luZG93LmxvY2F0aW9uLmhhc2gpO1xyXG59XHJcblxyXG5Sb3V0ZXIucHJvdG90eXBlID0ge1xyXG4gICAgaGFuZGxlcjogZnVuY3Rpb24gKGhhc2gpIHtcclxuICAgICAgICB0aGlzLnByZXZpb3VzUm91dGUgPSB0aGlzLmN1cnJlbnRSb3V0ZTtcclxuICAgICAgICB0aGlzLnByZXZpb3VzUGFyYW1zID0gdGhpcy5jdXJyZW50UGFyYW1zO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFJvdXRlID0gdGhpcy5maW5kTmV3Um91dGUoaGFzaCk7XHJcbiAgICAgICAgdGhpcy5sYXVuY2hIYW5kbGVycygpO1xyXG4gICAgfSxcclxuICAgIGZpbmROZXdSb3V0ZTogZnVuY3Rpb24gKGhhc2gpIHtcclxuICAgICAgICBoYXNoID0gaGFzaC5zbGljZSgxKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnJvdXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMucm91dGVzW2ldO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIChlbGVtZW50Lm1hdGNoKSA9PSAnc3RyaW5nJyAmJiBlbGVtZW50Lm1hdGNoID09PSBoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXJhbXMgPSAnJztcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKGVsZW1lbnQubWF0Y2gpID09ICdmdW5jdGlvbicgJiYgZWxlbWVudC5tYXRjaChoYXNoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gJyc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoKGVsZW1lbnQubWF0Y2ggaW5zdGFuY2VvZiBSZWdFeHApICYmIGVsZW1lbnQubWF0Y2gudGVzdChoYXNoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gaGFzaC5tYXRjaChlbGVtZW50Lm1hdGNoKSB8fCBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhcmFtcy5zcGxpY2UoMCwgMSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBsYXVuY2hIYW5kbGVycygpIHtcclxuICAgICAgICBQcm9taXNlLnJlc29sdmUoKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7IHRoaXMucHJldmlvdXNSb3V0ZSAmJiB0aGlzLnByZXZpb3VzUm91dGUub25MZWF2ZSAmJiB0aGlzLnByZXZpb3VzUm91dGUub25MZWF2ZSh0aGlzLnByZXZpb3VzUGFyYW1zKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB0aGlzLmN1cnJlbnRSb3V0ZSAmJiB0aGlzLmN1cnJlbnRSb3V0ZS5vbkJlZm9yZUVudGVyICYmIHRoaXMuY3VycmVudFJvdXRlLm9uQmVmb3JlRW50ZXIodGhpcy5jdXJyZW50UGFyYW1zKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB0aGlzLmN1cnJlbnRSb3V0ZSAmJiB0aGlzLmN1cnJlbnRSb3V0ZS5vbkVudGVyICYmIHRoaXMuY3VycmVudFJvdXRlLm9uRW50ZXIodGhpcy5jdXJyZW50UGFyYW1zKTsgfSk7XHJcbiAgICB9XHJcbn07Il19
