!function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return c(a[t][1][e]||e)},i,i.exports,o,a,s,u)}return s[t].exports}for(var h="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=e("./hero"),a=(r=o)&&r.__esModule?r:{default:r};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=800,this.height=800,this.level=1,this.baseSpeed=5,this.canvas=document.querySelector("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.hero=new a.default(this),this.gamePlays=!1,this.runGame(),this.timer=0}return i(e,[{key:"runGame",value:function(){var e=this;this.gamePlays=!0,this.timer=setInterval(function(){e.context.clearRect(0,0,e.width,e.height),e.context.drawImage(e.hero.getNextSprite(),e.hero.position.x,e.hero.position.y,115,100)},30)}},{key:"pauseGame",value:function(){this.gamePlays=!1,clearInterval(this.timer)}}]),e}();n.default=s},{"./hero":2}],2:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i,o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),a=e("./person"),s=(i=a)&&i.__esModule?i:{default:i};var u=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":r(t))&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,".cat-img"));return t.setUpHero(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":r(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,s.default),o(n,[{key:"getPosition",value:function(){}},{key:"setUpHero",value:function(){var t=this;document.addEventListener("keydown",function(e){37===e.keyCode&&(t.position.x-=5),38===e.keyCode&&(t.position.y-=5),39===e.keyCode&&(t.position.x+=5),40===e.keyCode&&(t.position.y+=5)})}}]),n}();n.default=u},{"./person":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.mainHero=n,this.game=e,this.directionAngle=this.mainHero?0:2*Math.PI*Math.random(),this.position={x:0,y:0},this.sprites=[].slice.call(document.querySelectorAll(t)),this.speed=e.level*e.baseSpeed,this.currentImg=0}return i(r,[{key:"getNextSprite",value:function(){return this.step(),this.currentImg>=this.sprites.length&&(this.currentImg=0),this.sprites[this.currentImg++]}},{key:"step",value:function(){this.position.x+=Math.cos(this.directionAngle)*this.speed,this.position.x>this.game.width&&(this.position.x=0),this.position.x<0&&(this.position.x=this.game.width),this.position.y+=Math.sin(this.directionAngle)*this.speed,this.position.y>this.game.height&&(this.position.y=0),this.position.y<0&&(this.position.y=this.game.height)}}]),r}();n.default=r},{}],4:[function(e,t,n){"use strict";var r=o(e("./utils/router")),i=o(e("./routes"));function o(e){return e&&e.__esModule?e:{default:e}}new r.default(i.default)},{"./routes":5,"./utils/router":7}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(e("./gameObjects/gameState")),o=i(e("./utils/detectMobile"));function i(e){return e&&e.__esModule?e:{default:e}}var a=document.querySelector(".content");!function(){if((0,o.default)()){var e=document.createElement("div");e.classList.add("buttons");var t=document.createElement("button");t.innerHTML="<",t.classList.add("left");var n=document.createElement("button");n.innerHTML="^",n.classList.add("up");var r=document.createElement("button");r.innerHTML=">",r.classList.add("right");var i=document.createElement("button");i.innerHTML="v",i.classList.add("down"),e.appendChild(t),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.addEventListener("click",function(e){if(e.target.matches(".right")){var t=new Event("keydown");return t.keyCode=39,void document.dispatchEvent(t)}if(e.target.matches(".left")){var n=new Event("keydown");return n.keyCode=37,void document.dispatchEvent(n)}if(e.target.matches(".up")){var r=new Event("keydown");return r.keyCode=38,void document.dispatchEvent(r)}if(e.target.matches(".down")){var i=new Event("keydown");return i.keyCode=40,void document.dispatchEvent(i)}}),document.body.appendChild(e)}}();var s=[{match:"",onEnter:function(){window.location.hash="game"}},{match:"about",onEnter:function(){u("about"),a.innerHTML='<h1 class="about"><span>Super game Cats vs Ninjas</span><h1>'}},{match:"game",onEnter:function(){u("game");var e=document.createElement("canvas");a.innerHTML="",a.appendChild(e),new r.default}},{match:"scores",onEnter:function(){u("scores"),a.innerHTML='<h1 class="about"><span>Scores</span><h1>'}}];function u(e){document.querySelector(".active").className="",document.querySelector('[href="#'+e+'"]').parentElement.className="active"}n.default=s},{"./gameObjects/gameState":1,"./utils/detectMobile":6}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}},{}],7:[function(e,t,n){"use strict";function r(e){var t=this;this.routes=e||[],this.currentRoute,this.previousRoute,this.currentParams,this.previousParams,window.addEventListener("hashchange",function(){t.handler(window.location.hash)}),this.handler(window.location.hash)}Object.defineProperty(n,"__esModule",{value:!0}),(n.default=r).prototype={handler:function(e){this.previousRoute=this.currentRoute,this.previousParams=this.currentParams,this.currentRoute=this.findNewRoute(e),this.launchHandlers()},findNewRoute:function(e){e=e.slice(1);for(var t=0;t<this.routes.length;t++){var n=this.routes[t];if("string"==typeof n.match&&n.match===e)return this.currentParams="",n;if("function"==typeof n.match&&n.match(e))return this.currentParams="",n;if(n.match instanceof RegExp&&n.match.test(e))return this.currentParams=e.match(n.match)||[],this.currentParams.splice(0,1),n}},launchHandlers:function(){var e=this;Promise.resolve().then(function(){e.previousRoute&&e.previousRoute.onLeave&&e.previousRoute.onLeave(e.previousParams)}).then(function(){e.currentRoute&&e.currentRoute.onBeforeEnter&&e.currentRoute.onBeforeEnter(e.currentParams)}).then(function(){e.currentRoute&&e.currentRoute.onEnter&&e.currentRoute.onEnter(e.currentParams)})}}},{}]},{},[4]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZ2FtZU9iamVjdHMvZ2FtZVN0YXRlLmpzIiwic3JjL2pzL2dhbWVPYmplY3RzL2hlcm8uanMiLCJzcmMvanMvZ2FtZU9iamVjdHMvcGVyc29uLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvcm91dGVzLmpzIiwic3JjL2pzL3V0aWxzL2RldGVjdE1vYmlsZS5qcyIsInNyYy9qcy91dGlscy9yb3V0ZXIuanMiXSwibmFtZXMiOlsiciIsImUiLCJuIiwidCIsIm8iLCJpIiwiZiIsImMiLCJyZXF1aXJlIiwidSIsImEiLCJFcnJvciIsImNvZGUiLCJwIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiX2hlcm8iLCJHYW1lU3RhdGUiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwid2lkdGgiLCJoZWlnaHQiLCJsZXZlbCIsImJhc2VTcGVlZCIsImNhbnZhcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiaGVybyIsIl9oZXJvMiIsImRlZmF1bHQiLCJnYW1lUGxheXMiLCJydW5HYW1lIiwidGltZXIiLCJfdGhpcyIsInNldEludGVydmFsIiwiY2xlYXJSZWN0IiwiZHJhd0ltYWdlIiwiZ2V0TmV4dFNwcml0ZSIsInBvc2l0aW9uIiwieCIsInkiLCJjbGVhckludGVydmFsIiwiX3BlcnNvbiIsIkhlcm8iLCJnYW1lU3RhdGUiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsIl9fcHJvdG9fXyIsIk9iamVjdCIsImdldFByb3RvdHlwZU9mIiwic2V0VXBIZXJvIiwiX3BlcnNvbjIiLCJfdGhpczIiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXlDb2RlIiwiUGVyc29uIiwic2VsZWN0b3IiLCJtYWluSGVybyIsImdhbWUiLCJkaXJlY3Rpb25BbmdsZSIsIk1hdGgiLCJQSSIsInJhbmRvbSIsInNwcml0ZXMiLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzcGVlZCIsImN1cnJlbnRJbWciLCJzdGVwIiwiY29zIiwic2luIiwiX3JvdXRlcjIiLCJfcm91dGVzMiIsImNvbnRlbnQiLCJfZGV0ZWN0TW9iaWxlMiIsImRpdkZvckJ1dHRvbnMiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYnV0dG9uTGVmdCIsImlubmVySFRNTCIsImJ1dHRvblVwIiwiYnV0dG9uUmlnaHQiLCJidXR0b25Eb3duIiwiYXBwZW5kQ2hpbGQiLCJ0YXJnZXQiLCJtYXRjaGVzIiwiRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwiX2UiLCJfZTIiLCJfZTMiLCJib2R5IiwiYWRkQnV0dG9uc0Zvck1vYmlsZSIsInJvdXRlcyIsIm1hdGNoIiwib25FbnRlciIsIndpbmRvdyIsImxvY2F0aW9uIiwiaGFzaCIsImNoYW5nZUFjdGl2ZVBhZ2UiLCJfZ2FtZVN0YXRlMiIsIm5ld1BhZ2UiLCJjbGFzc05hbWUiLCJwYXJlbnRFbGVtZW50IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiUm91dGVyIiwicm91dGVQYXJhbXMiLCJjdXJyZW50Um91dGUiLCJwcmV2aW91c1JvdXRlIiwiY3VycmVudFBhcmFtcyIsInByZXZpb3VzUGFyYW1zIiwiaGFuZGxlciIsInByb3RvdHlwZSIsImZpbmROZXdSb3V0ZSIsImxhdW5jaEhhbmRsZXJzIiwiZWxlbWVudCIsIlJlZ0V4cCIsInRlc3QiLCJzcGxpY2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJvbkxlYXZlIiwib25CZWZvcmVFbnRlciJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsRUFBQUMsRUFBQUMsR0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUFBLElBQUFKLEVBQUFHLEdBQUEsQ0FBQSxJQUFBSixFQUFBSSxHQUFBLENBQUEsSUFBQUUsRUFBQSxtQkFBQUMsU0FBQUEsUUFBQSxJQUFBRixHQUFBQyxFQUFBLE9BQUFBLEVBQUFGLEdBQUEs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QUE4RixjQUFBLEdBQ0FNLEVBRUosR0FBSSxtQkFBUUEsRUFBUnRCLE9BQXdDc0IsRUFBQXRCLE1BQTVDSSxHQUVJLE9BREFsRixLQUFBOEYsY0FBQSxHQUNBTSxFQUVKLEdBQUtBLEVBQUF0QixpQkFBRHVCLFFBQXFDRCxFQUFBdEIsTUFBQXdCLEtBQXpDcEIsR0FHSSxPQUZBbEYsS0FBQThGLGNBQXFCWixFQUFBSixNQUFXc0IsRUFBWHRCLFFBQXJCLEdBQ0E5RSxLQUFBOEYsY0FBQVMsT0FBQSxFQUFBLEdBQ0FILElBdkJHRCxlQUFBLFdBMkJFLElBQUFqRSxFQUFBbEMsS0FDYndHLFFBQUFDLFVBQUFDLEtBQ1UsV0FBUXhFLEVBQUEyRCxlQUFzQjNELEVBQUEyRCxjQUF0QmMsU0FBb0R6RSxFQUFBMkQsY0FBQWMsUUFBMkJ6RSxFQUEvRTZELGtCQURsQlcsS0FFVSxXQUFReEUsRUFBQTBELGNBQXFCMUQsRUFBQTBELGFBQXJCZ0IsZUFBd0QxRSxFQUFBMEQsYUFBQWdCLGNBQWdDMUUsRUFBeEY0RCxpQkFGbEJZLEtBR1UsV0FBUXhFLEVBQUEwRCxjQUFxQjFELEVBQUEwRCxhQUFyQmIsU0FBa0Q3QyxFQUFBMEQsYUFBQWIsUUFBMEI3QyxFQUE1RTREIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgSGVybyBmcm9tICcuL2hlcm8nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVN0YXRlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMud2lkdGggPSA4MDA7XHJcblx0XHR0aGlzLmhlaWdodCA9IDgwMDtcclxuXHRcdHRoaXMubGV2ZWwgPSAxO1xyXG5cdFx0dGhpcy5iYXNlU3BlZWQgPSA1O1xyXG5cdFx0dGhpcy5jYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdjYW52YXMnKTtcclxuXHRcdHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53aWR0aDtcclxuXHRcdHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuaGVpZ2h0O1xyXG5cclxuXHRcdHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG5cdFx0dGhpcy5oZXJvID0gbmV3IEhlcm8odGhpcyk7XHJcblx0XHR0aGlzLmdhbWVQbGF5cyA9IGZhbHNlO1xyXG5cdFx0dGhpcy5ydW5HYW1lKCk7XHJcblx0XHR0aGlzLnRpbWVyID0gMDtcclxuXHR9XHJcblxyXG5cdHJ1bkdhbWUoKSB7XHJcblx0XHR0aGlzLmdhbWVQbGF5cyA9IHRydWU7XHJcblx0XHR0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0aGlzLmhlcm8uZ2V0TmV4dFNwcml0ZSgpLCB0aGlzLmhlcm8ucG9zaXRpb24ueCwgdGhpcy5oZXJvLnBvc2l0aW9uLnksIDExNSwgMTAwKTtcclxuXHRcdH0sIDMwKTtcclxuXHR9XHJcblx0cGF1c2VHYW1lKCkge1xyXG5cdFx0dGhpcy5nYW1lUGxheXMgPSBmYWxzZTtcclxuXHRcdGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCBQZXJzb24gZnJvbSAnLi9wZXJzb24nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGVybyBleHRlbmRzIFBlcnNvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lU3RhdGUpIHtcclxuICAgICAgICBzdXBlcihnYW1lU3RhdGUsICcuY2F0LWltZycpO1xyXG4gICAgICAgIHRoaXMuc2V0VXBIZXJvKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldFBvc2l0aW9uKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRVcEhlcm8oKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCAtPSA1O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzOCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi55IC09IDU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnggKz0gNTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gNDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSArPSA1O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGVyc29uIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWVTdGF0ZSwgc2VsZWN0b3IsIG1haW5IZXJvKSB7XHJcbiAgICAgICAgdGhpcy5tYWluSGVybyA9IG1haW5IZXJvO1xyXG4gICAgICAgIHRoaXMuZ2FtZSA9IGdhbWVTdGF0ZTtcclxuICAgICAgICB0aGlzLmRpcmVjdGlvbkFuZ2xlID0gdGhpcy5tYWluSGVybyA/IDAgOiAyICogTWF0aC5QSSAqIE1hdGgucmFuZG9tKCk7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgeDogMCxcclxuICAgICAgICAgICAgeTogMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zcHJpdGVzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XHJcbiAgICAgICAgdGhpcy5zcGVlZCA9IGdhbWVTdGF0ZS5sZXZlbCAqIGdhbWVTdGF0ZS5iYXNlU3BlZWQ7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SW1nID0gMDtcclxuICAgIH1cclxuICAgIGdldE5leHRTcHJpdGUoKSB7XHJcbiAgICAgICAgdGhpcy5zdGVwKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEltZyA+PSB0aGlzLnNwcml0ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEltZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNwcml0ZXNbdGhpcy5jdXJyZW50SW1nKytdO1xyXG4gICAgfVxyXG4gICAgc3RlcCgpIHtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnggKz0gTWF0aC5jb3ModGhpcy5kaXJlY3Rpb25BbmdsZSkgKiB0aGlzLnNwZWVkO1xyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnggPiB0aGlzLmdhbWUud2lkdGgpIHtcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi54ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24ueCA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi54ID0gdGhpcy5nYW1lLndpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnkgKz0gTWF0aC5zaW4odGhpcy5kaXJlY3Rpb25BbmdsZSkgKiB0aGlzLnNwZWVkO1xyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnkgPiB0aGlzLmdhbWUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnkgPCAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSA9IHRoaXMuZ2FtZS5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBjbGFzcyBEdW1teUVuZW15IGV4dGVuZHMgUGVyc29uIHtcclxuLy8gICAgIGNvbnN0cnVjdG9yKGdhbWVTdGF0ZSkge1xyXG4vLyAgICAgICAgIHN1cGVyKGdhbWVTdGF0ZSk7XHJcbi8vICAgICAgICAgc3ByaXRlcyA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm5pbmphLWltZycpKTtcclxuLy8gICAgIH1cclxuLy8gICAgIHN0ZXAoKXtcclxuLy8gICAgICAgICB0aGlzLnBvc2l0aW9uXHJcbi8vICAgICB9XHJcbi8vIH0iLCJpbXBvcnQgUm91dGVyIGZyb20gJy4vdXRpbHMvcm91dGVyJztcclxuaW1wb3J0IHJvdXRlcyBmcm9tICcuL3JvdXRlcyc7XHJcblxyXG5uZXcgUm91dGVyKHJvdXRlcyk7IiwiaW1wb3J0IEdhbWVTdGF0ZSBmcm9tICcuL2dhbWVPYmplY3RzL2dhbWVTdGF0ZSc7XHJcbmltcG9ydCBkZXRlY3RNb2JpbGUgZnJvbSAnLi91dGlscy9kZXRlY3RNb2JpbGUnO1xyXG5cclxubGV0IGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpO1xyXG5hZGRCdXR0b25zRm9yTW9iaWxlKCk7XHJcblxyXG5jb25zdCByb3V0ZXMgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgbWF0Y2g6ICcnLFxyXG4gICAgICAgIG9uRW50ZXI6ICgpID0+IHtcclxuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnZ2FtZSc7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBtYXRjaDogJ2Fib3V0JyxcclxuICAgICAgICBvbkVudGVyOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNoYW5nZUFjdGl2ZVBhZ2UoJ2Fib3V0Jyk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gJzxoMSBjbGFzcz1cImFib3V0XCI+PHNwYW4+U3VwZXIgZ2FtZSBDYXRzIHZzIE5pbmphczwvc3Bhbj48aDE+JztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG1hdGNoOiAnZ2FtZScsXHJcbiAgICAgICAgb25FbnRlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICBjaGFuZ2VBY3RpdmVQYWdlKCdnYW1lJyk7XHJcbiAgICAgICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChjYW52YXMpO1xyXG4gICAgICAgICAgICBuZXcgR2FtZVN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBtYXRjaDogJ3Njb3JlcycsXHJcbiAgICAgICAgb25FbnRlcjogKCkgPT4ge1xyXG4gICAgICAgICAgICBjaGFuZ2VBY3RpdmVQYWdlKCdzY29yZXMnKTtcclxuICAgICAgICAgICAgY29udGVudC5pbm5lckhUTUwgPSAnPGgxIGNsYXNzPVwiYWJvdXRcIj48c3Bhbj5TY29yZXM8L3NwYW4+PGgxPic7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXTtcclxuXHJcbmZ1bmN0aW9uIGNoYW5nZUFjdGl2ZVBhZ2UobmV3UGFnZSkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZScpLmNsYXNzTmFtZSA9ICcnO1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2hyZWY9XCIjJHtuZXdQYWdlfVwiXWApLnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lID0gJ2FjdGl2ZSc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEJ1dHRvbnNGb3JNb2JpbGUoKSB7XHJcbiAgICBpZiAoZGV0ZWN0TW9iaWxlKCkpIHtcclxuXHJcbiAgICAgICAgdmFyIGRpdkZvckJ1dHRvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBkaXZGb3JCdXR0b25zLmNsYXNzTGlzdC5hZGQoJ2J1dHRvbnMnKTtcclxuXHJcbiAgICAgICAgdmFyIGJ1dHRvbkxlZnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBidXR0b25MZWZ0LmlubmVySFRNTCA9ICc8JztcclxuICAgICAgICBidXR0b25MZWZ0LmNsYXNzTGlzdC5hZGQoJ2xlZnQnKTtcclxuXHJcbiAgICAgICAgdmFyIGJ1dHRvblVwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgYnV0dG9uVXAuaW5uZXJIVE1MID0gJ14nO1xyXG4gICAgICAgIGJ1dHRvblVwLmNsYXNzTGlzdC5hZGQoJ3VwJyk7XHJcblxyXG4gICAgICAgIHZhciBidXR0b25SaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGJ1dHRvblJpZ2h0LmlubmVySFRNTCA9ICc+JztcclxuICAgICAgICBidXR0b25SaWdodC5jbGFzc0xpc3QuYWRkKCdyaWdodCcpO1xyXG5cclxuICAgICAgICB2YXIgYnV0dG9uRG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGJ1dHRvbkRvd24uaW5uZXJIVE1MID0gJ3YnO1xyXG4gICAgICAgIGJ1dHRvbkRvd24uY2xhc3NMaXN0LmFkZCgnZG93bicpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGRpdkZvckJ1dHRvbnMuYXBwZW5kQ2hpbGQoYnV0dG9uTGVmdCk7XHJcbiAgICAgICAgZGl2Rm9yQnV0dG9ucy5hcHBlbmRDaGlsZChidXR0b25VcCk7XHJcbiAgICAgICAgZGl2Rm9yQnV0dG9ucy5hcHBlbmRDaGlsZChidXR0b25SaWdodCk7XHJcbiAgICAgICAgZGl2Rm9yQnV0dG9ucy5hcHBlbmRDaGlsZChidXR0b25Eb3duKTtcclxuXHJcbiAgICAgICAgZGl2Rm9yQnV0dG9ucy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm1hdGNoZXMoJy5yaWdodCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IG5ldyBFdmVudCgna2V5ZG93bicpO1xyXG4gICAgICAgICAgICAgICAgZS5rZXlDb2RlID0gMzk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQubWF0Y2hlcygnLmxlZnQnKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBuZXcgRXZlbnQoJ2tleWRvd24nKTtcclxuICAgICAgICAgICAgICAgIGUua2V5Q29kZSA9IDM3O1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm1hdGNoZXMoJy51cCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IG5ldyBFdmVudCgna2V5ZG93bicpO1xyXG4gICAgICAgICAgICAgICAgZS5rZXlDb2RlID0gMzg7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQubWF0Y2hlcygnLmRvd24nKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBuZXcgRXZlbnQoJ2tleWRvd24nKTtcclxuICAgICAgICAgICAgICAgIGUua2V5Q29kZSA9IDQwO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdkZvckJ1dHRvbnMpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCByb3V0ZXM7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRldGVjdG1vYmlsZSgpIHtcclxuICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpXHJcbiAgICAgICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvd2ViT1MvaSlcclxuICAgICAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSlcclxuICAgICAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGFkL2kpXHJcbiAgICAgICAgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBvZC9pKVxyXG4gICAgICAgIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0JsYWNrQmVycnkvaSlcclxuICAgICAgICB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9XaW5kb3dzIFBob25lL2kpXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufSIsIi8qKlxyXG4gKiDQpNGD0L3QutGG0LjRjyDQtNC70Y8g0LTQvtCx0LDQstC70LXQvdC40Y8g0Lgg0L7QsdGA0LDQsdC+0YLQutC4INGA0L7Rg9GC0L7QsiDQvdCwINGB0YLRgNCw0L3QuNGG0LVcclxuICogQHBhcmFtIHsqfSByb3V0ZVBhcmFtcyDQvNCw0YHRgdC40LIg0L/QsNGA0LDQvNC10YLRgNC+0LIg0LTQu9GPINC+0LHRgNCw0LHQvtGC0LrQuCDRgNC+0YPRgtC+0LJcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFJvdXRlcihyb3V0ZVBhcmFtcykge1xyXG4gICAgdGhpcy5yb3V0ZXMgPSByb3V0ZVBhcmFtcyB8fCBbXTtcclxuICAgIHRoaXMuY3VycmVudFJvdXRlO1xyXG4gICAgdGhpcy5wcmV2aW91c1JvdXRlO1xyXG4gICAgdGhpcy5jdXJyZW50UGFyYW1zO1xyXG4gICAgdGhpcy5wcmV2aW91c1BhcmFtcztcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlcih3aW5kb3cubG9jYXRpb24uaGFzaCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuaGFuZGxlcih3aW5kb3cubG9jYXRpb24uaGFzaCk7XHJcbn1cclxuXHJcblJvdXRlci5wcm90b3R5cGUgPSB7XHJcbiAgICBoYW5kbGVyOiBmdW5jdGlvbiAoaGFzaCkge1xyXG4gICAgICAgIHRoaXMucHJldmlvdXNSb3V0ZSA9IHRoaXMuY3VycmVudFJvdXRlO1xyXG4gICAgICAgIHRoaXMucHJldmlvdXNQYXJhbXMgPSB0aGlzLmN1cnJlbnRQYXJhbXM7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Um91dGUgPSB0aGlzLmZpbmROZXdSb3V0ZShoYXNoKTtcclxuICAgICAgICB0aGlzLmxhdW5jaEhhbmRsZXJzKCk7XHJcbiAgICB9LFxyXG4gICAgZmluZE5ld1JvdXRlOiBmdW5jdGlvbiAoaGFzaCkge1xyXG4gICAgICAgIGhhc2ggPSBoYXNoLnNsaWNlKDEpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucm91dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5yb3V0ZXNbaV07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKGVsZW1lbnQubWF0Y2gpID09ICdzdHJpbmcnICYmIGVsZW1lbnQubWF0Y2ggPT09IGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhcmFtcyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiAoZWxlbWVudC5tYXRjaCkgPT0gJ2Z1bmN0aW9uJyAmJiBlbGVtZW50Lm1hdGNoKGhhc2gpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXJhbXMgPSAnJztcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgoZWxlbWVudC5tYXRjaCBpbnN0YW5jZW9mIFJlZ0V4cCkgJiYgZWxlbWVudC5tYXRjaC50ZXN0KGhhc2gpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQYXJhbXMgPSBoYXNoLm1hdGNoKGVsZW1lbnQubWF0Y2gpIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zLnNwbGljZSgwLCAxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGxhdW5jaEhhbmRsZXJzKCkge1xyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHsgdGhpcy5wcmV2aW91c1JvdXRlICYmIHRoaXMucHJldmlvdXNSb3V0ZS5vbkxlYXZlICYmIHRoaXMucHJldmlvdXNSb3V0ZS5vbkxlYXZlKHRoaXMucHJldmlvdXNQYXJhbXMpOyB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7IHRoaXMuY3VycmVudFJvdXRlICYmIHRoaXMuY3VycmVudFJvdXRlLm9uQmVmb3JlRW50ZXIgJiYgdGhpcy5jdXJyZW50Um91dGUub25CZWZvcmVFbnRlcih0aGlzLmN1cnJlbnRQYXJhbXMpOyB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7IHRoaXMuY3VycmVudFJvdXRlICYmIHRoaXMuY3VycmVudFJvdXRlLm9uRW50ZXIgJiYgdGhpcy5jdXJyZW50Um91dGUub25FbnRlcih0aGlzLmN1cnJlbnRQYXJhbXMpOyB9KTtcclxuICAgIH1cclxufTsiXX0=
